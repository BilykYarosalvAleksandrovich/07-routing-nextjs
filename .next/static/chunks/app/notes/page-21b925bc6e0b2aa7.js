(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{9221:function(e,t,n){Promise.resolve().then(n.bind(n,1374))},1374:function(e,t,n){"use strict";n.d(t,{default:function(){return w}});var a=n(7437),s=n(2265),i=n(1632),o=n(2094),r=n(1931),l=n(3464),c=n(3577);let u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImJpbHlrLnlhcm9zbGF2LmFsZWtzYW5kcm92aWNoQGdtYWlsLmNvbSIsImlhdCI6MTc2NDAxMDg0M30.jOJ1e0HAEUJ2KFZyulQcq0DJJDmPAFZbmQMyuqyG6OQ";if(!u)throw console.error("❌ NEXT_PUBLIC_NOTEHUB_TOKEN is missing. Add it to .env.local and restart the server."),Error("NEXT_PUBLIC_NOTEHUB_TOKEN is missing");let d=l.default.create({baseURL:"https://notehub-public.goit.study/api",headers:{Authorization:"Bearer ".concat(u),"Content-Type":"application/json"}}),h=async e=>{try{return(await d.get("/notes",{params:{page:e.page,perPage:e.perPage,search:e.search,tag:e.tag||void 0}})).data}catch(e){var t;throw(0,c.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when fetching notes"),e}},p=async e=>{try{return(await d.delete("/notes/".concat(e))).data}catch(e){var t;throw(0,c.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when deleting note"),e}};var g=n(551),_=n.n(g);function N(e){let{value:t,onChange:n}=e;return(0,a.jsx)("input",{className:_().input,type:"text",placeholder:"Search notes",value:t,onChange:e=>{n(e.target.value)}})}var m=n(5103),v=n.n(m),x=n(729),b=n.n(x);function L(e){let{current:t,totalPages:n,onPageChange:s}=e;return n<=1?null:(0,a.jsx)("nav",{className:b().paginationWrapper,children:(0,a.jsx)(v(),{breakLabel:"...",nextLabel:">",onPageChange:e=>{s(e.selected+1)},pageRangeDisplayed:3,marginPagesDisplayed:1,pageCount:n,forcePage:t-1,previousLabel:"<",renderOnZeroPageCount:null,containerClassName:b().pagination,pageLinkClassName:b().pageLink,activeLinkClassName:b().activeLink,previousLinkClassName:b().prevNextLink,nextLinkClassName:b().prevNextLink,breakLinkClassName:b().breakLink,disabledClassName:b().disabled})})}var f=n(9827),j=n(1770),y=n(4231),C=n.n(y),k=n(7648);function P(e){let{notes:t}=e,n=(0,f.useQueryClient)(),s=(0,j.useMutation)({mutationFn:e=>p(e),onSuccess:()=>{n.invalidateQueries({queryKey:["notes"]})},onError:e=>{console.error("Error deleting note:",e),alert("Failed to delete note. See console for details.")}}),i=e=>{s.mutate(e)};return t&&0!==t.length?(0,a.jsx)("ul",{className:C().list,children:t.map(e=>(0,a.jsxs)("li",{className:C().listItem,children:[(0,a.jsx)("h2",{className:C().title,children:e.title}),(0,a.jsx)("p",{className:C().content,children:e.content}),(0,a.jsxs)("div",{className:C().footer,children:[(0,a.jsx)("span",{className:C().tag,children:e.tag}),(0,a.jsx)(k.default,{href:"/notes/".concat(e.id),className:C().detailsLink,children:"View details"}),(0,a.jsx)("button",{className:C().button,onClick:()=>i(e.id),disabled:s.isPending,children:"Delete"})]})]},e.id))}):null}var I=n(4146),E=n.n(I);function w(e){var t;let{dehydratedState:n}=e,[l,c]=(0,s.useState)(""),[u,d]=(0,s.useState)(1),[p]=(0,r.Nr)(l,500),{data:g,isLoading:_,isError:m,isFetching:v}=(0,i.useQuery)({queryKey:["notes",u,p],queryFn:()=>h({page:u,perPage:8,search:p}),placeholderData:e=>e});return(0,a.jsx)(o.HydrationBoundary,{state:n,children:(0,a.jsxs)("div",{className:E().container,children:[(0,a.jsxs)("header",{className:E().toolbar,children:[(0,a.jsx)(N,{value:l,onChange:c}),g&&g.totalPages>1&&(0,a.jsx)(L,{current:u,totalPages:g.totalPages,onPageChange:d})]}),(0,a.jsxs)("main",{children:[_&&(0,a.jsx)("p",{children:"Loading notes..."}),v&&!_&&(0,a.jsx)("p",{children:"Updating results..."}),m&&(0,a.jsx)("p",{children:"Something went wrong"}),(null==g?void 0:null===(t=g.notes)||void 0===t?void 0:t.length)?(0,a.jsx)(P,{notes:g.notes}):!_&&(0,a.jsx)("p",{children:"No notes found"})]})]})})}},4146:function(e){e.exports={container:"Notes_container__YZugq",toolbar:"Notes_toolbar__vxiBS",button:"Notes_button__E1JoO"}},4231:function(e){e.exports={list:"NoteList_list__shWPg",listItem:"NoteList_listItem__SuGUK",title:"NoteList_title__yrB3L",content:"NoteList_content__K8ntu",button:"NoteList_button__J1AiO",footer:"NoteList_footer__lWpqj",tag:"NoteList_tag__obj_m"}},729:function(e){e.exports={pagination:"Pagination_pagination__O7JWM",active:"Pagination_active__awQnD"}},551:function(e){e.exports={input:"SearchBox_input__0g6b5"}}},function(e){e.O(0,[501,972,954,197,524,971,117,744],function(){return e(e.s=9221)}),_N_E=e.O()}]);