(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{4581:function(e,t,n){Promise.resolve().then(n.bind(n,5150)),Promise.resolve().then(n.bind(n,2094)),Promise.resolve().then(n.bind(n,4984)),Promise.resolve().then(n.bind(n,9827)),Promise.resolve().then(n.bind(n,4147)),Promise.resolve().then(n.bind(n,2868)),Promise.resolve().then(n.bind(n,7026)),Promise.resolve().then(n.bind(n,1770)),Promise.resolve().then(n.bind(n,6451)),Promise.resolve().then(n.bind(n,8164)),Promise.resolve().then(n.bind(n,1632)),Promise.resolve().then(n.bind(n,3244)),Promise.resolve().then(n.bind(n,7985)),Promise.resolve().then(n.bind(n,7984))},5150:function(e,t,n){"use strict";n.d(t,{default:function(){return G}});var o=n(7437),a=n(2265),s=n(1632),r=n(8584),i=n(1931),l=n(3464),c=n(3577);let d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImJpbHlrLnlhcm9zbGF2LmFsZWtzYW5kcm92aWNoQGdtYWlsLmNvbSIsImlhdCI6MTc2NDAxMDg0M30.jOJ1e0HAEUJ2KFZyulQcq0DJJDmPAFZbmQMyuqyG6OQ";if(!d)throw console.error("❌ NEXT_PUBLIC_NOTEHUB_TOKEN is missing. Add it to .env.local and restart the server."),Error("NEXT_PUBLIC_NOTEHUB_TOKEN is missing");let u=l.default.create({baseURL:"https://notehub-public.goit.study/api",headers:{Authorization:"Bearer ".concat(d),"Content-Type":"application/json"}}),m=async e=>{try{return(await u.get("/notes",{params:{page:e.page,perPage:e.perPage,search:e.search,tag:e.tag||void 0}})).data}catch(e){var t;throw(0,c.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when fetching notes"),e}},h=async e=>{try{return(await u.post("/notes",e)).data}catch(e){var t;throw(0,c.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when creating note"),e}},_=async e=>{try{return(await u.delete("/notes/".concat(e))).data}catch(e){var t;throw(0,c.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when deleting note"),e}};var p=n(551),g=n.n(p);function N(e){let{value:t,onChange:n}=e;return(0,o.jsx)("input",{className:g().input,type:"text",placeholder:"Search notes",value:t,onChange:e=>{n(e.target.value)}})}var v=n(5103),b=n.n(v),x=n(729),j=n.n(x);function f(e){let{current:t,totalPages:n,onPageChange:a}=e;return n<=1?null:(0,o.jsx)("nav",{className:j().paginationWrapper,children:(0,o.jsx)(b(),{breakLabel:"...",nextLabel:">",onPageChange:e=>{a(e.selected+1)},pageRangeDisplayed:3,marginPagesDisplayed:1,pageCount:n,forcePage:t-1,previousLabel:"<",renderOnZeroPageCount:null,containerClassName:j().pagination,pageLinkClassName:j().pageLink,activeLinkClassName:j().activeLink,previousLinkClassName:j().prevNextLink,nextLinkClassName:j().prevNextLink,breakLinkClassName:j().breakLink,disabledClassName:j().disabled})})}var C=n(9827),P=n(1770),y=n(4231),k=n.n(y),L=n(7648);function w(e){let{notes:t}=e,n=(0,C.useQueryClient)(),a=(0,P.useMutation)({mutationFn:e=>_(e),onSuccess:()=>{n.invalidateQueries({queryKey:["notes"]})},onError:e=>{console.error("Error deleting note:",e),alert("Failed to delete note. See console for details.")}}),s=e=>{a.mutate(e)};return t&&0!==t.length?(0,o.jsx)("ul",{className:k().list,children:t.map(e=>(0,o.jsxs)("li",{className:k().listItem,children:[(0,o.jsx)("h2",{className:k().title,children:e.title}),(0,o.jsx)("p",{className:k().content,children:e.content}),(0,o.jsxs)("div",{className:k().footer,children:[(0,o.jsx)("span",{className:k().tag,children:e.tag}),(0,o.jsx)(L.default,{href:"/notes/".concat(e.id),className:k().detailsLink,children:"View details"}),(0,o.jsx)("button",{className:k().button,onClick:()=>s(e.id),disabled:a.isPending,children:"Delete"})]})]},e.id))}):null}var E=n(6637),F=n(7314),I=n(4422),S=n(7127),B=n.n(S);let T=["Todo","Work","Personal","Meeting","Shopping"],O=I.Ry().shape({title:I.Z_().min(3,"Title must be at least 3 characters").max(50,"Title must be at most 50 characters").required("Title is required"),content:I.Z_().max(500,"Content must be at most 500 characters"),tag:I.Z_().oneOf(T,"Invalid tag selected").required("Tag is required")});function q(e){let{onClose:t,onNoteCreated:n}=e,a=(0,C.useQueryClient)(),s=(0,P.useMutation)({mutationFn:e=>h(e),onSuccess:()=>{a.invalidateQueries({queryKey:["notes"]}),n(),t()},onError:e=>{console.error("Error creating note:",e),alert("Failed to create note. See console for details.")}});return(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Create note"}),(0,o.jsx)(F.J9,{initialValues:{title:"",content:"",tag:"Todo"},validationSchema:O,onSubmit:e=>{s.mutate(e)},children:e=>{let{isSubmitting:n}=e;return(0,o.jsxs)(F.l0,{className:B().form,children:[(0,o.jsxs)("div",{className:B().formGroup,children:[(0,o.jsx)("label",{htmlFor:"title",children:"Title"}),(0,o.jsx)(F.gN,{id:"title",name:"title",className:B().input}),(0,o.jsx)(F.Bc,{name:"title",component:"span",className:B().error})]}),(0,o.jsxs)("div",{className:B().formGroup,children:[(0,o.jsx)("label",{htmlFor:"content",children:"Content"}),(0,o.jsx)(F.gN,{id:"content",name:"content",as:"textarea",rows:8,className:B().textarea}),(0,o.jsx)(F.Bc,{name:"content",component:"span",className:B().error})]}),(0,o.jsxs)("div",{className:B().formGroup,children:[(0,o.jsx)("label",{htmlFor:"tag",children:"Tag"}),(0,o.jsx)(F.gN,{id:"tag",name:"tag",as:"select",className:B().select,children:T.map(e=>(0,o.jsx)("option",{value:e,children:e},e))}),(0,o.jsx)(F.Bc,{name:"tag",component:"span",className:B().error})]}),(0,o.jsxs)("div",{className:B().actions,children:[(0,o.jsx)("button",{type:"button",className:B().cancelButton,onClick:t,disabled:s.isPending,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:B().submitButton,disabled:n||s.isPending,children:s.isPending?"Creating...":"Create note"})]}),s.isError&&(0,o.jsx)("p",{className:B().apiError,children:"Error: Failed to create note. Please try again."})]})}})]})}var J=n(4146),U=n.n(J);function G(e){var t;let{dehydratedState:n}=e,[l,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(1),[h,_]=(0,a.useState)(!1),[p]=(0,i.Nr)(l,500),{data:g,isLoading:v,isError:b,isFetching:x}=(0,s.useQuery)({queryKey:["notes",d,p],queryFn:()=>m({page:d,perPage:8,search:p}),placeholderData:e=>e});return(0,o.jsx)(r.R,{state:n,children:(0,o.jsxs)("div",{className:U().container,children:[(0,o.jsxs)("header",{className:U().toolbar,children:[(0,o.jsx)(N,{value:l,onChange:e=>{c(e),u(1)}}),g&&g.totalPages>1&&(0,o.jsx)(f,{current:d,totalPages:null!==(t=g.totalPages)&&void 0!==t?t:1,onPageChange:e=>u(e)}),(0,o.jsx)("button",{className:U().button,onClick:()=>_(!0),children:"Create note +"})]}),(0,o.jsxs)("main",{children:[v&&!g&&(0,o.jsx)("p",{children:"Loading notes..."}),x&&!v&&(0,o.jsx)("p",{children:"Updating results..."}),b&&(0,o.jsx)("p",{children:"Something went wrong loading notes."}),(null==g?void 0:g.notes)&&g.notes.length>0?(0,o.jsx)(w,{notes:g.notes}):!v&&!b&&(0,o.jsx)("p",{children:"No notes found"})]}),h&&(0,o.jsx)(E.default,{onClose:()=>_(!1),children:(0,o.jsx)(q,{onClose:()=>_(!1),onNoteCreated:()=>{c(""),u(1),_(!1)}})})]})})}},6637:function(e,t,n){"use strict";n.d(t,{default:function(){return l}});var o=n(7437),a=n(2265),s=n(4887),r=n(3565),i=n.n(r);function l(e){let{children:t,onClose:n}=e;(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n]);let r=document.getElementById("modal-root");return r?s.createPortal((0,o.jsx)("div",{className:i().overlay,onClick:n,children:(0,o.jsx)("div",{className:i().modal,onClick:e=>e.stopPropagation(),children:t})}),r):null}},8584:function(e,t,n){"use strict";n.d(t,{R:function(){return a.HydrationBoundary},default:function(){return l}});var o=n(7437),a=n(2094),s=n(4114),r=n(9827),i=n(2265);function l(e){let{children:t}=e,[n]=(0,i.useState)(()=>new s.S({defaultOptions:{queries:{staleTime:5e3}}}));return(0,o.jsx)(r.QueryClientProvider,{client:n,children:t})}},4146:function(e){e.exports={container:"Notes_container__YZugq",toolbar:"Notes_toolbar__vxiBS",button:"Notes_button__E1JoO"}},3565:function(e){e.exports={backdrop:"Modal_backdrop__bLvvH",modal:"Modal_modal__nSuXm"}},7127:function(e){e.exports={form:"NoteForm_form__kBK_0",formGroup:"NoteForm_formGroup__bS5ba",input:"NoteForm_input__28hgd",textarea:"NoteForm_textarea__kzing",select:"NoteForm_select__Go8Rq",actions:"NoteForm_actions__aG_Xr",submitButton:"NoteForm_submitButton__vSvUI",cancelButton:"NoteForm_cancelButton__c33li",error:"NoteForm_error__swtoj"}},4231:function(e){e.exports={list:"NoteList_list__shWPg",listItem:"NoteList_listItem__SuGUK",title:"NoteList_title__yrB3L",content:"NoteList_content__K8ntu",button:"NoteList_button__J1AiO",footer:"NoteList_footer__lWpqj",tag:"NoteList_tag__obj_m"}},729:function(e){e.exports={pagination:"Pagination_pagination__O7JWM",active:"Pagination_active__awQnD"}},551:function(e){e.exports={input:"SearchBox_input__0g6b5"}}},function(e){e.O(0,[758,545,200,50,971,117,744],function(){return e(e.s=4581)}),_N_E=e.O()}]);