(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{4581:function(e,t,n){Promise.resolve().then(n.bind(n,3477)),Promise.resolve().then(n.bind(n,2094)),Promise.resolve().then(n.bind(n,4984)),Promise.resolve().then(n.bind(n,9827)),Promise.resolve().then(n.bind(n,4147)),Promise.resolve().then(n.bind(n,2868)),Promise.resolve().then(n.bind(n,7026)),Promise.resolve().then(n.bind(n,1770)),Promise.resolve().then(n.bind(n,6451)),Promise.resolve().then(n.bind(n,8164)),Promise.resolve().then(n.bind(n,1632)),Promise.resolve().then(n.bind(n,3244)),Promise.resolve().then(n.bind(n,7985)),Promise.resolve().then(n.bind(n,7984))},3477:function(e,t,n){"use strict";n.d(t,{default:function(){return B}});var o=n(7437),r=n(2265),s=n(1632),a=n(8584),i=n(1931),l=n(9116),c=n(551),u=n.n(c);function d(e){let{value:t,onChange:n}=e;return(0,o.jsx)("input",{className:u().input,type:"text",placeholder:"Search notes",value:t,onChange:e=>{n(e.target.value)}})}var m=n(5103),h=n.n(m),_=n(729),p=n.n(_);function g(e){let{current:t,totalPages:n,onPageChange:r}=e;return n<=1?null:(0,o.jsx)("nav",{className:p().paginationWrapper,children:(0,o.jsx)(h(),{breakLabel:"...",nextLabel:">",onPageChange:e=>{r(e.selected+1)},pageRangeDisplayed:3,marginPagesDisplayed:1,pageCount:n,forcePage:t-1,previousLabel:"<",renderOnZeroPageCount:null,containerClassName:p().pagination,pageLinkClassName:p().pageLink,activeLinkClassName:p().activeLink,previousLinkClassName:p().prevNextLink,nextLinkClassName:p().prevNextLink,breakLinkClassName:p().breakLink,disabledClassName:p().disabled})})}var v=n(9827),N=n(1770),b=n(4231),x=n.n(b),f=n(7648);function j(e){let{notes:t}=e,n=(0,v.useQueryClient)(),r=(0,N.useMutation)({mutationFn:e=>(0,l.f_)(e),onSuccess:()=>{n.invalidateQueries({queryKey:["notes"]})},onError:e=>{console.error("Error deleting note:",e),alert("Failed to delete note. See console for details.")}}),s=e=>{r.mutate(e)};return t&&0!==t.length?(0,o.jsx)("ul",{className:x().list,children:t.map(e=>(0,o.jsxs)("li",{className:x().listItem,children:[(0,o.jsx)("h2",{className:x().title,children:e.title}),(0,o.jsx)("p",{className:x().content,children:e.content}),(0,o.jsxs)("div",{className:x().footer,children:[(0,o.jsx)("span",{className:x().tag,children:e.tag}),(0,o.jsx)(f.default,{href:"/notes/".concat(e.id),className:x().detailsLink,children:"View details"}),(0,o.jsx)("button",{className:x().button,onClick:()=>s(e.id),disabled:r.isPending,children:"Delete"})]})]},e.id))}):null}var y=n(6637),C=n(7314),P=n(4422),k=n(7127),L=n.n(k);let w=["Todo","Work","Personal","Meeting","Shopping"],E=P.Ry().shape({title:P.Z_().min(3,"Title must be at least 3 characters").max(50,"Title must be at most 50 characters").required("Title is required"),content:P.Z_().max(500,"Content must be at most 500 characters"),tag:P.Z_().oneOf(w,"Invalid tag selected").required("Tag is required")});function F(e){let{onClose:t,onNoteCreated:n}=e,r=(0,v.useQueryClient)(),s=(0,N.useMutation)({mutationFn:e=>(0,l.kT)(e),onSuccess:()=>{r.invalidateQueries({queryKey:["notes"]}),n(),t()},onError:e=>{console.error("Error creating note:",e),alert("Failed to create note. See console for details.")}});return(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Create note"}),(0,o.jsx)(C.J9,{initialValues:{title:"",content:"",tag:"Todo"},validationSchema:E,onSubmit:e=>{s.mutate(e)},children:e=>{let{isSubmitting:n}=e;return(0,o.jsxs)(C.l0,{className:L().form,children:[(0,o.jsxs)("div",{className:L().formGroup,children:[(0,o.jsx)("label",{htmlFor:"title",children:"Title"}),(0,o.jsx)(C.gN,{id:"title",name:"title",className:L().input}),(0,o.jsx)(C.Bc,{name:"title",component:"span",className:L().error})]}),(0,o.jsxs)("div",{className:L().formGroup,children:[(0,o.jsx)("label",{htmlFor:"content",children:"Content"}),(0,o.jsx)(C.gN,{id:"content",name:"content",as:"textarea",rows:8,className:L().textarea}),(0,o.jsx)(C.Bc,{name:"content",component:"span",className:L().error})]}),(0,o.jsxs)("div",{className:L().formGroup,children:[(0,o.jsx)("label",{htmlFor:"tag",children:"Tag"}),(0,o.jsx)(C.gN,{id:"tag",name:"tag",as:"select",className:L().select,children:w.map(e=>(0,o.jsx)("option",{value:e,children:e},e))}),(0,o.jsx)(C.Bc,{name:"tag",component:"span",className:L().error})]}),(0,o.jsxs)("div",{className:L().actions,children:[(0,o.jsx)("button",{type:"button",className:L().cancelButton,onClick:t,disabled:s.isPending,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:L().submitButton,disabled:n||s.isPending,children:s.isPending?"Creating...":"Create note"})]}),s.isError&&(0,o.jsx)("p",{className:L().apiError,children:"Error: Failed to create note. Please try again."})]})}})]})}var I=n(4146),S=n.n(I);function B(e){var t;let{dehydratedState:n}=e,[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(1),[_,p]=(0,r.useState)(!1),[v]=(0,i.Nr)(c,500),{data:N,isLoading:b,isError:x,isFetching:f}=(0,s.useQuery)({queryKey:["notes",m,v],queryFn:()=>(0,l.jO)({page:m,perPage:8,search:v}),placeholderData:e=>e});return(0,o.jsx)(a.R,{state:n,children:(0,o.jsxs)("div",{className:S().container,children:[(0,o.jsxs)("header",{className:S().toolbar,children:[(0,o.jsx)(d,{value:c,onChange:e=>{u(e),h(1)}}),N&&N.totalPages>1&&(0,o.jsx)(g,{current:m,totalPages:null!==(t=N.totalPages)&&void 0!==t?t:1,onPageChange:e=>h(e)}),(0,o.jsx)("button",{className:S().button,onClick:()=>p(!0),children:"Create note +"})]}),(0,o.jsxs)("main",{children:[b&&!N&&(0,o.jsx)("p",{children:"Loading notes..."}),f&&!b&&(0,o.jsx)("p",{children:"Updating results..."}),x&&(0,o.jsx)("p",{children:"Something went wrong loading notes."}),(null==N?void 0:N.notes)&&N.notes.length>0?(0,o.jsx)(j,{notes:N.notes}):!b&&!x&&(0,o.jsx)("p",{children:"No notes found"})]}),_&&(0,o.jsx)(y.Z,{onClose:()=>p(!1),children:(0,o.jsx)(F,{onClose:()=>p(!1),onNoteCreated:()=>{u(""),h(1),p(!1)}})})]})})}},6637:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var o=n(7437),r=n(2265),s=n(4887),a=n(3565),i=n.n(a);function l(e){let{onClose:t,children:n}=e,a=(0,r.useRef)(null),[l,c]=(0,r.useState)(null);return((0,r.useEffect)(()=>{c(document.querySelector("#modal-root"))},[]),(0,r.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.code&&t()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t]),l)?s.createPortal((0,o.jsx)("div",{className:i().backdrop,ref:a,onClick:e=>{e.target===a.current&&t()},children:(0,o.jsx)("div",{className:i().modal,children:n})}),l):null}},8584:function(e,t,n){"use strict";n.d(t,{R:function(){return r.HydrationBoundary},default:function(){return l}});var o=n(7437),r=n(2094),s=n(4114),a=n(9827),i=n(2265);function l(e){let{children:t}=e,[n]=(0,i.useState)(()=>new s.S({defaultOptions:{queries:{staleTime:5e3}}}));return(0,o.jsx)(a.QueryClientProvider,{client:n,children:t})}},9116:function(e,t,n){"use strict";n.d(t,{f_:function(){return u},jO:function(){return i},kT:function(){return c},nb:function(){return l}});var o=n(3464),r=n(3577);let s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImJpbHlrLnlhcm9zbGF2LmFsZWtzYW5kcm92aWNoQGdtYWlsLmNvbSIsImlhdCI6MTc2NDAxMDg0M30.jOJ1e0HAEUJ2KFZyulQcq0DJJDmPAFZbmQMyuqyG6OQ";if(!s)throw console.error("❌ NEXT_PUBLIC_NOTEHUB_TOKEN is missing. Add it to .env.local and restart the server."),Error("NEXT_PUBLIC_NOTEHUB_TOKEN is missing");let a=o.default.create({baseURL:"https://notehub-public.goit.study/api",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}}),i=async e=>{try{return(await a.get("/notes",{params:{page:e.page,perPage:e.perPage,search:e.search,tag:e.tag||void 0}})).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when fetching notes"),e}},l=async e=>{try{return(await a.get("/notes/".concat(e))).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when fetching note by ID"),e}},c=async e=>{try{return(await a.post("/notes",e)).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when creating note"),e}},u=async e=>{try{return(await a.delete("/notes/".concat(e))).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("❌ 401 Unauthorized when deleting note"),e}}},4146:function(e){e.exports={container:"Notes_container__YZugq",toolbar:"Notes_toolbar__vxiBS",button:"Notes_button__E1JoO"}},3565:function(e){e.exports={backdrop:"Modal_backdrop__bLvvH",modal:"Modal_modal__nSuXm"}},7127:function(e){e.exports={form:"NoteForm_form__kBK_0",formGroup:"NoteForm_formGroup__bS5ba",input:"NoteForm_input__28hgd",textarea:"NoteForm_textarea__kzing",select:"NoteForm_select__Go8Rq",actions:"NoteForm_actions__aG_Xr",submitButton:"NoteForm_submitButton__vSvUI",cancelButton:"NoteForm_cancelButton__c33li",error:"NoteForm_error__swtoj"}},4231:function(e){e.exports={list:"NoteList_list__shWPg",listItem:"NoteList_listItem__SuGUK",title:"NoteList_title__yrB3L",content:"NoteList_content__K8ntu",button:"NoteList_button__J1AiO",footer:"NoteList_footer__lWpqj",tag:"NoteList_tag__obj_m"}},729:function(e){e.exports={pagination:"Pagination_pagination__O7JWM",active:"Pagination_active__awQnD"}},551:function(e){e.exports={input:"SearchBox_input__0g6b5"}}},function(e){e.O(0,[562,545,577,200,944,971,117,744],function(){return e(e.s=4581)}),_N_E=e.O()}]);